---
title: "tidy_data"
output: github_document
date: "2025-09-24"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#literally what does this mean
```

# Kale's Class on Tidy!

```{r}
library(tidyverse)
library(readxl)
library(haven)
```

This document will show how to tidy data

## Pivot Longer

```{r}
pulse_df = 
  read_sas("./data/public_pulse_data.sas7bdat") |>
  janitor::clean_names() |> 
  pivot_longer(
    cols = bdi_score_bl:bdi_score_12m,
   #identifies the columns that we want to pivot, then below we want to rename the column, with a descriptor of what are these data telling us?
   names_to = "visit",
   values_to = "bdi_score",
   names_prefix = "bdi_score_"
  ) |> 
#change [visit]=bl to a months value using mutate
mutate(visit = replace(visit, visit == "bl", "00m")) |> 

#A purely cosmetic action :) -> put ID first

relocate(id, visit)

```
Comments while creating our df:

first thing you'll notice is that youre data has a lot more rows (it's a lot longer). Instead of one row per ID, we have 4 

so basically we created a column that contains the original values in that first header rower that contained bdi_score_bl:bdi_score_12m, and we created a column that contained the values associated with each score. 

`r values_to` almost always with a long transformation youll get big values in the visit/time variable because youll get these time values into a string whcih is why you use `names_prefix`. Check what visit column values look like now


### Let's do one more example
Notes:
when you are using `r read_csv` and are importing data, and setting a data path, you can use tab to get the file name easily!

`r case_match` --> there are a bunch of things that do this, but for this function you give it a variable, and then you give it a list of values of the old variable and then the new value that you want to replace it with using a tilda. 

`r case_when` similar to `r case_match` better for several variables or for more complicated scenarios (you can use boolean questions and depending on the responses you can change the values)

```{r}
litters_df =
  read_csv("data/FAS_litters.csv", na = c("NA", ".", "")) |> 
  janitor::clean_names() |> 
  pivot_longer(
    cols = gd0_weight:gd18_weight,
    names_to = "gd_time",
    values_to = "Weight"
  ) |> 
  
  #change values within gd_time
  
  mutate(gd_time = case_match(
    gd_time,
    "gd0_weight" ~ 0,
    "gd18_weight" ~ 18
  ))


```

## Pivot Wider

Let's make up an analysis results table

```{r}
analysis_df=
  tibble(group = c("treatment","treatment","control","control"),
         time = c("pre","post","pre","post"),
         mean = c(4, 10, 4.2, 5)
         )
```

Pivot wider for human readablility

```{r}
analysis_df |> 
pivot_wider(
  names_from = time,
  values_from = mean
) |> 
  knitr::kable() #this line creates a nicer looking table

#looking at the output is much easier this way as a human. So is Looking at a difference or finding a trend

#using the pipe function like this creates an output without officially creating an actual dataframe
```












